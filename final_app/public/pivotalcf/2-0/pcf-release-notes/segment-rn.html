<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Always force latest IE rendering engine or request Chrome Frame -->
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,300italic,400italic,400,600' rel='stylesheet' type='text/css'>
  <!-- Use title if it's in the page YAML frontmatter -->
  <title>
      PCF Isolation Segment v1.12 Release Notes |
    Pivotal Docs
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="/stylesheets/all.css" rel="stylesheet" media="screen, print" />
  <link href="/stylesheets/print.css" rel="stylesheet" media="print" />
  <link href='/images/favicon.ico' rel='shortcut icon'>

  <script src="/javascripts/all.js"></script>
  
<script type="text/javascript">
  if (window.location.host === 'docs.pivotal.io') {
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-39702075-1']);
    _gaq.push(['_setDomainName', 'pivotal.io']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script');
      ga.type = 'text/javascript';
      ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(ga, s);
    })();
  }
</script>

<script type="text/javascript">
  var blackList = ['acceptance'];

  blackList.forEach(function(blackListedEnv) {
    if (document.URL.indexOf(blackListedEnv) > -1 && blackListedEnv != "") {
      $('head').append('<meta name="hashtag" content="PivotalMoment">');
    }
  });
</script>

<!-- CrazyEgg Tracking Script -->
  <script type="text/javascript">
  setTimeout(function(){var a=document.createElement("script");
  var b=document.getElementsByTagName("script")[0];
  a.src=document.location.protocol+"//script.crazyegg.com/pages/scripts/0055/2990.js?"+Math.floor(new Date().getTime()/3600000);
  a.async=true;a.type="text/javascript";b.parentNode.insertBefore(a,b)}, 1);
  </script>

<!-- Munchkin Marketo Script -->
<script type="text/javascript">
  (function() {
    var didInit = false;

    function initMunchkin() {
      if (didInit === false) {
        didInit = true;
        Munchkin.init('625-IUJ-009');
      }
    }

    var s = document.createElement('script');
    s.type = 'text/javascript';
    s.async = true;
    s.src = document.location.protocol + '//munchkin.marketo.net/munchkin.js';
    s.onreadystatechange = function() {
      if (this.readyState == 'complete' || this.readyState == 'loaded') {
        initMunchkin();
      }
    };
    s.onload = initMunchkin;
    document.getElementsByTagName('head')[0].appendChild(s);
  })();
</script>

</head>

<body class="pivotalcf pivotalcf_2-0 pivotalcf_2-0_pcf-release-notes pivotalcf_2-0_pcf-release-notes_segment-rn has-subnav">

<div class="viewport">
  <div class='wrap'>
    <script type="text/javascript">
      document.domain = "pivotal.io";
    </script>

      <header class="global-header header header-layout js-bar-links">
    <a class="pivotal-logo" href="/">
    </a>
    <a href="/" class="global-header-title">
      <span class="title-deemph">Pivotal</span> Documentation
    </a>
    <div class="btn-menu" data-behavior="MenuMobile"></div>
    <div class="header-links">
      <div class="header-item">
        <a href="https://network.pivotal.io/">Downloads</a>
      </div>
      <div class="header-item">
        <a href="http://support.pivotal.io" target="_blank">Support</a>
      </div>

      <div class="header-item embedded-searchbar">
          <form method="get" action="/search">
            <input name="q" placeholder="Search PCF Release Notes" class="search-box" />
              <input type="hidden" name="product_name" value="PCF Metrics" />
              <input type="hidden" name="product_version" value="2.0"/>
          </form>
      </div>
      
    </div>
  </header>



    <div class="container">

      <!--googleoff: index-->
      <div id="sub-nav" class="js-sidenav nav-container" role="navigation">
  <a class="sidenav-title" data-behavior="SubMenuMobile">
    Doc Index
  </a>
  <div class="nav-content">
    <ul>
    <li class="has_submenu">
        <a href="/pivotalcf/2-0/pcf-release-notes/index.html">Release Notes</a>
        <ul>
          <li class="">
            <a href="/pivotalcf/2-0/pcf-release-notes/breaking-changes.html">PCF v1.12 Breaking Changes</a>
          </li>
          <li class="">
            <a href="/pivotalcf/2-0/pcf-release-notes/runtime-rn.html">Pivotal Elastic Runtime Release Notes</a>
          </li>
          <li class="">
            <a href="/pivotalcf/2-0/pcf-release-notes/opsmanager-rn.html">Pivotal Operations Manager Release Notes</a>
          </li>
          <li class="">
            <a href="/pivotalcf/2-0/pcf-release-notes/windows-rn.html">PCF Runtime for Windows Release Notes</a>
          </li>
          <li class="">
            <a href="/pivotalcf/2-0/pcf-release-notes/segment-rn.html">PCF Isolation Segment Release Notes</a>
          </li>
          <li class="">
            <a href="/pivotalcf/2-0/pcf-release-notes/stemcell-rn.html">Stemcell Release Notes</a>
          </li>
          <li class="">
            <a href="/pivotalcf/2-0/pcf-release-notes/windows-stemcell-rn.html">Windows Stemcell Release Notes</a>
          </li>
          <li class="">
            <a href="/pivotalcf/2-0/pcf-release-notes/bbr-pcf-rn.html">BOSH Backup and Restore Release Notes</a>
          </li>
        </ul>
  </div>
</div><!--end of sub-nav-->

      <!--googleon: index-->

      <main class="content content-layout" id="js-content" role="main">
        <a id="top"></a>
          <div class="local-header title-container">
    <div class="local-header version-info">
      LATEST VERSION: 2.0 - <a href="">CHANGELOG</a>
    </div>
    <div class="local-header local-title clearfix">
      <img src="/images/cloud_rings.png">
      <span class="local-header-title">PCF Metrics
      </span>
      <span class="local-header local-version header-dropdown">
        <a class="local-header header-dropdown-link">v2.0</a>
        <span class="local-header header-dropdown-content">
          <ul>
          </ul>
        </span>
      </span>

      <!-- search was here -->
    </div>
    <div class="local-header local-header-links">
    </div>
  </div>

          <h1 class="title-container" >
    PCF Isolation Segment v1.12 Release Notes
  </h1>

          <div id="js-quick-links" >
            <div class="quick-links"><ul>
<li>
<a href="#releases">Releases</a><ul><li><a href="#1-12-0">1.12.0</a></li></ul>
</li>
<li><a href="#intro">About PCF Isolation Segment</a></li>
<li><a href="#install">How to Install</a></li>
<li>
<a href="#1.12.0">New Features in PCF Isolation Segment v1.12.0</a><ul>
<li><a href="#haproxy">HAProxy</a></li>
<li><a href="#sharding">Router Sharding Mode</a></li>
<li><a href="#router-config">Router Configuration Options</a></li>
<li><a href="#networking-poe">Simplified TLS Configuration</a></li>
<li><a href="#app-header">Mutual TLS Headers on Inbound Application Traffic</a></li>
<li><a href="#app-traffic">Support for Logging All App Traffic</a></li>
<li><a href="#groot">Introducing GrootFS</a></li>
<li><a href="#garden-cleanup">Garden Disk-Cleanup</a></li>
<li><a href="#max-in-flight">Diego Cell Max-in-Flight Default</a></li>
<li><a href="#diego-metron">Secure Communication Between Diego and Loggregator</a></li>
<li><a href="#ldap-volume">NFSV3 Volume Services with LDAP</a></li>
<li><a href="#app-id-creds">Application Instance Identity Credentials</a></li>
<li><a href="#c2c">Container-to-Container Networking Updates</a></li>
</ul>
</li>
<li><a href="#adv-features">About Advanced Features</a></li>
</ul></div>
          </div>
        <div class="to-top" id="js-to-top">
          <a href="#top" title="back to top"></a>
        </div>
        <h2><a id='releases'></a> Releases</h2>

<h3><a id='1-12-0'></a> 1.12.0</h3>

<p><table border="1" class="nice">
  <thead>
  <tr>
    <th>Component</th>
    <th>Version</th>
  </tr>
  </thead>
  <tbody>
  <tr>
    <td>Stemcell</td><td>3445.7</td>
  </tr><tr>
    <td>cf-networking</td><td>1.4.0</td>
  </tr><tr>
    <td>cflinuxfs2</td><td>1.146.0</td>
  </tr><tr>
    <td>consul</td><td>173</td>
  </tr><tr>
    <td>diego</td><td>1.25.1</td>
  </tr><tr>
    <td>garden-runc</td><td>1.9.3</td>
  </tr><tr>
    <td>grootfs</td><td>0.25.0</td>
  </tr><tr>
    <td>haproxy</td><td>8.4.0</td>
  </tr><tr>
    <td>loggregator</td><td>96</td>
  </tr><tr>
    <td>nfs-volume</td><td>1.0.9</td>
  </tr><tr>
    <td>routing</td><td>0.162.0</td>
  </tr><tr>
    <td>syslog-migration</td><td>8</td>
  </tr>
  </tbody>
  <tfoot>
  <tr>
    <td colspan="2"><em>* Components marked with an asterisk have been patched to resolve security vulnerabilities or fix component behavior.</em></td>
  </tr>
  </tfoot>
  </table></p>

<h2><a id='intro'></a> About PCF Isolation Segment</h2>

<p>The PCF Isolation Segment v1.12 tile is available for installation with PCF
v1.12.</p>

<p><a href="../concepts/security.html#isolation-segments">Isolation segments</a> provide
dedicated pools of resources where you can deploy apps and  isolate workloads.
Using isolation segments separates app resources as completely as if they were
in different CF deployments but avoids redundant management and network
complexity.</p>

<p>For more information about using isolation segments in your deployment, see the
<a href="../adminguide/isolation-segments.html">Managing Isolation Segments</a> topic.</p>

<h2><a id='install'></a> How to Install</h2>

<p>The procedure for installing PCF Isolation Segment v1.12 is documented in the
<a href="../customizing/installing-pcf-is.html">Installing PCF Isolation Segment</a> topic.</p>

<p>To install a PCF Isolation Segment, you must first install PCF v1.12.</p>

<h2><a id='1.12.0'></a> New Features in PCF Isolation Segment v1.12.0</h2>

<p>This section describes new features of the release.</p>

<h3><a id='haproxy'></a> HAProxy</h3>

<p>You can now use an HAProxy for the Isolation Segment tile that is independent from the Elastic Runtime HAProxy. The Isolation Segment tile includes its own HAProxy VM, which uses the 
<a href="https://github.com/cloudfoundry-incubator/haproxy-boshrelease">haproxy-boshrelease</a>. For information on the configuration options for HAProxy, see the <a href="../customizing/installing-pcf-is.html#networking">Networking</a> section of <em>Installing PCF Isolation Segment</em>. </p>

<p>See the Isolation Segment <a href="../customizing/installing-pcf-is.html#networking">installation instructions</a> for more information.</p>

<h3><a id='sharding'></a> Router Sharding Mode</h3>

<p>This release includes support for router sharding between the Elastic Runtime and Isolation Segment tiles. In addition to compute isolation, operators can now configure networking isolation for their isolation segments. Alternatively, operators can deploy the Isolation Segment tile for the purpose of using its routers for the Elastic Runtime tile. </p>

<p>You can configure this feature using the following fields:</p>

<ul>
<li>Elastic Runtime tile: <strong>Routers reject requests for Isolation Segments</strong> checkbox</li>
<li>Isolation Segment tile: <strong>Router Sharding Mode</strong> selector</li>
</ul>

<p>See the Isolation Segment <a href="../customizing/installing-pcf-is.html#networking">installation instructions</a> for more information.</p>

<h3><a id='router-config'></a> Router Configuration Options</h3>

<p>The <strong>Networking</strong> pane of the Isolation Segment tile now includes the following fields for the router.  Additionally, the default instance count for the <strong>Router</strong> VM is now set to <code>3</code> in the <strong>Resource Config</strong> pane. </p>

<ul>
<li><strong>Router Max Idle Keepalive Connections</strong> </li>
<li><strong>Disable SSL certificate verification for this environment</strong></li>
<li><strong>HTTP Headers to Log</strong></li>
<li><strong>Disable insecure cookies on the Router</strong></li>
<li><strong>Enable Zipkin tracking headers on the router</strong></li>
<li><strong>Router Timeout to Backends</strong></li>
<li><strong>Load Balancer Unhealthy Threshold</strong></li>
<li><strong>Load Balancer Healthy Threshold</strong></li>
<li><strong>Max Connections Per Backend</strong></li>
</ul>

<p>See the Isolation Segment <a href="../customizing/installing-pcf-is.html#networking">installation instructions</a> for more information about each field.</p>

<h3><a id='networking-poe'></a> Simplified TLS Configuration</h3>

<p>The point of entry options on the Isolation Segment tile <strong>Networking</strong> pane have been restructured to be
more understandable and flexible.  Operators no longer need to configure
the Router or HAProxy separately as both components are configured using
the same options. This includes the following changes:</p>

<ul>
<li>Gorouter and HAProxy always listen for TLS requests. You provide an SSL certificate for both Gorouter and HAProxy using a single field. </li>
<li>HAProxy forwards all requests to Gorouter over TLS by default. You can optionally disable this feature. </li>
<li>You can configure the minimum version of TLS for Gorouter and HAProxy with a single field. </li>
<li>You can provide a list of CAs to HAProxy for it to validate the Gorouter certificate. </li>
<li>You can optionally disable the HTTP listener for both Gorouter and HAProxy with a single checkbox. </li>
<li>You can specify TLS cipher suites for HAProxy and Gorouter independently.</li>
</ul>

<h3><a id='app-header'></a> Mutual TLS Headers on Inbound Application Traffic</h3>

<p>Gorouter can now forward the <code>X-Forwarded-Client-Cert</code> header to app
instances when provided. Alternatively, operators can configure Gorouter to
forward the header only when the mutual TLS connection from the client can be
validated. Additionally, operators may now configure Gorouter to overwrite the
XFCC header with the client certificate received in mTLS handshakes.</p>

<p>This configuration is available in the <strong>Networking</strong> pane under <strong>Configure the CF Router support for the X-Forwarded-Client-Cert header</strong>. See the Isolation Segment <a href="../customizing/installing-pcf-is.html#networking">installation instructions</a> for more information.</p>

<h3><a id='app-traffic'></a> Support for Logging All App Traffic</h3>

<p>Operators can enable logging of all accepted and denied packets due to ASGs or container-to-container networking policies. This provides more visibility into app traffic, including denied traffic.</p>

<p>Operators configure this global logging in the <strong>Networking</strong> pane of the Isolation Segment tile under the <strong>Log traffic for all accepted/denied application packets</strong> field. See the <a href="../opsguide/logging-config-opsman.html#app-traffic-log">App Traffic Logging</a> section for more information.</p>

<h3><a id='groot'></a> Introducing GrootFS</h3>

<p>GrootFS is the new container image management plugin for Garden-runC.
It helps with the filesystem isolation of Garden-runC containers,
image caching,
and disk quota enforcement.
GrootFS replaces the previous built-in functionality,
which used an obsolete layer filesystem (AUFS)
that lacks support from the Linux Kernel community.
Additionally, GrootFS uses <a href="https://www.opencontainers.org/">OCI</a> standards
for <a href="http://github.com/opencontainers/image-spec">container images</a>.</p>

<p>For more information about GrootFS in PCF, see the following topics:</p>

<ul>
<li><a href="../concepts/container-security.html#mechanics">Understanding Container Security</a></li>
<li><a href="../concepts/architecture/garden.html#garden-rootfs">Component: Garden</a></li>
</ul>

<h3><a id='garden-cleanup'></a> Garden Disk-Cleanup</h3>

<p>Operators using PCF Isolation Segment can now configure the Garden and GrootFS cleanup thresholds independently of the Elastic Runtime tile. The <strong>Application Containers</strong> pane of the Isolation Segment tile now includes the following selector: <strong>Docker Images Disk-Cleanup Scheduling on Cell VMs</strong>. </p>

<h3><a id='max-in-flight'></a> Diego Cell Max-in-Flight Default</h3>

<p>This release lowers the default max-in-flight percentage on 
Diego Cells to 4%. Previously, this value was set to 10%, which can cause the following issues in larger environments:</p>

<ul>
<li>Many simultaneous VM creates/deletes and BOSH blob updates placing
significant stress on the underlying infrastructure, especially on vSphere
which has a greater probability of being under-provisioned.</li>
<li>Cells that are draining are no longer available for allocation, resulting
in a 10% decrease in total memory and disk capacity during deployment. This
can cause deployments to no longer have sufficient total capacity to run all work, or to have insufficient headroom to place larger workloads
successfully.</li>
</ul>

<p>Operators can still use the Ops Manager API to configure this setting to fit their needs. For more information about this property, see <a href="../adminguide/diego-cell-upgrade.html">Managing Diego Cell Limits During Upgrade</a>.</p>

<h3><a id='diego-metron'></a> Secure Communication Between Diego and Loggregator</h3>

<p>Diego Cells now use the Metron API v2. This gRPC-based API supports mutual TLS authentication and secures the communication path between the Diego <code>rep</code> and Loggregator.</p>

<h3><a id='ldap-volume'></a> NFSV3 Volume Services with LDAP</h3>

<p>Operators can now configure LDAP for NFSv3 volume services. Using LDAP secures the NFSV3 volume service by preventing a developer from binding to an NFS share using an
arbitrary UID and potentially gaining access to sensitive data stored by another user or app. If you enable LDAP support, 
 developers must provide credentials for any user they wish
to bind as. See <a href="../opsguide/enable-vol-services.html">Enabling NFS Volume Services</a>.  </p>

<h3><a id='app-id-creds'></a> Application Instance Identity Credentials</h3>

<p>The instance identity system in Diego provides each app container with a PEM-encoded <a href="https://www.ietf.org/rfc/rfc5280.txt">X.509</a> certificate and <a href="https://tools.ietf.org/html/rfc3447">PKCS #1 RSA</a> private key. The values of the environment variables <code>CF_INSTANCE_CERT</code> and <code>CF_INSTANCE_KEY</code> contain the absolute paths to the certificate and private key files. The validity period is 3 years for the Instance Identity root and 2 years for the intermediate CA certificates.</p>

<p>See the <a href="../security/networking/tls-info.html#container-creds">App Instance Container Identity Credentials</a> section for more information.</p>

<h3><a id='c2c'></a> Container-to-Container Networking Updates</h3>

<p>Container-to-container networking is now always enabled. The commands are integrated with the cf CLI and now include the option to specify a port range when adding and removing policies. See <a href="../devguide/deploy-apps/cf-networking.html#create-policies">Create Policies for Container-to-Container Networking</a>. </p>

<h2><a id='adv-features'></a> About Advanced Features</h2>

<p>The Advanced Features section of the PCF Isolation Segment tile includes new
functionality that may have certain constraints.  Although these features are
fully supported, Pivotal recommends caution when using them in production.</p>

        <div><a id='repo-link' href='http://github.com/pivotal-cf/pcf-release-notes/tree/2.0/segment-rn.html.md.erb'>View the source for this page in GitHub</a></div>

      </main>
    </div>
  </div>
</div>

<div id="scrim"></div>

<div class="container">
  <footer class="site-footer-links">
    <div class="copyright">
  <a href='https://pivotal.io/privacy-policy'>Privacy Policy</a> | 
  <a href='https://pivotal.io/terms-of-use'>Terms of Use</a><br/>
  <a href='/'>Pivotal Documentation</a>
  &copy; 2017 <a href='https://pivotal.io'>Pivotal Software</a>, Inc. All Rights Reserved.
</div>
<div class="support">
  Need help? <a href="http://support.pivotal.io" target="_blank">Visit Support</a>
</div>

  </footer>
</div><!--end of container-->

</body>
</html>
